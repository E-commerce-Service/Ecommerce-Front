<div
   (click)="onCloseModal()"
   (keydown.enter)="onCloseModal()"
   class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 animate-fade-in animate-duration-300 animate-ease-out"
   tabindex="1"
>
   <div
      (click)="$event.stopPropagation()"
      (keydown.enter)="$event.stopPropagation()"
      class="bg-white rounded-xl shadow-2xl w-full max-w-lg mx-4 p-8 relative animate-jump-in animate-duration-300 animate-ease-out"
      tabindex="1"
   >
      <div class="flex items-start justify-between mb-4">
         <h2 class="text-2xl md:text-3xl text-primary font-bold">
            Qual a sua opinião?
         </h2>
         <button
            (click)="onCloseModal()"
            tabindex="1"
            class="p-1 rounded-full cursor-pointer text-gray-400 hover:text-primary hover:bg-gray-100 transition-colors"
            aria-label="Fechar modal"
            title="Fechar"
         >
            <img src="assets/icons/star.svg" alt="" />
         </button>
      </div>

      <p class="text-base text-gray-500 mb-8">
         Selecione uma nota e, se quiser, deixe um comentário.
      </p>

      <div class="space-y-8 flex flex-col items-center justify-center">
         <div class="text-center">
            <app-interactive-stars
               [rating]="rating"
               (ratingChange)="onRatingChanged($event)"
            >
            </app-interactive-stars>

            <p
               class="text-orange-base font-semibold mt-3 h-6 transition-opacity duration-300"
               [class.opacity-0]="rating === 0"
            >
               {{ ratingLabels[rating] || "" }}
            </p>
         </div>

         <div class="w-full">
            <label
               for="reviewContent"
               class="block text-base font-semibold text-primary mb-2"
            >
               Seu comentário (opcional)
            </label>
            <div class="relative">
               <textarea
                  id="reviewContent"
                  [(ngModel)]="content"
                  rows="5"
                  maxlength="500"
                  placeholder="Como foi sua experiência com o produto?"
                  tabindex="1"
                  class="w-full border border-gray-300 rounded-lg p-3 pr-14 placeholder:text-gray-500 focus:border-transparent transition resize-none"
               ></textarea>
               <span class="absolute bottom-3 right-4 text-xs text-gray-400">
                  {{ content.length }} / 500
               </span>
            </div>
         </div>
      </div>

      <div class="mt-10 flex items-center justify-end gap-4">
         <button
            (click)="onCloseModal()"
            tabindex="1"
            class="px-6 py-2.5 rounded-lg text-primary font-semibold hover:bg-gray-100 transition-colors"
         >
            Cancelar
         </button>

         <button
            (click)="onSubmit()"
            [disabled]="rating === 0"
            tabindex="1"
            class="px-6 py-2.5 rounded-lg bg-orange-base text-white font-bold transition-all duration-200 transform shadow-md hover:bg-orange-dark hover:scale-105 disabled:bg-gray-300 disabled:shadow-none disabled:transform-none disabled:cursor-not-allowed"
         >
            Avaliar
         </button>
      </div>
   </div>
</div>
