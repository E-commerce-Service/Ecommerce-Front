<div
   (click)="onCloseModal()"
   (keydown.enter)="onCloseModal()"
   class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 px-4 animate-fade-in animate-duration-300 animate-ease-out"
   tabindex="1"
>
   <div
      (click)="$event.stopPropagation()"
      (keydown.enter)="$event.stopPropagation()"
      class="bg-white rounded-2xl shadow-2xl w-full max-w-lg p-6 md:p-8 relative flex flex-col gap-6 animate-jump-in animate-duration-300 animate-ease-out"
      tabindex="1"
   >
      <div class="flex items-start justify-between">
         <div>
            <h2
               class="text-xl md:text-2xl text-primary font-bold leading-tight"
            >
               Qual a sua opinião?
            </h2>
            <p class="text-sm md:text-base text-gray-500 mt-1">
               Avalie sua experiência com o produto.
            </p>
         </div>

         <button
            (click)="onCloseModal()"
            class="p-2 -mt-2 -mr-2 rounded-full text-gray-400 hover:text-primary hover:bg-gray-100 transition-colors"
            aria-label="Fechar modal"
            title="Fechar"
         >
            <svg
               xmlns="http://www.w3.org/2000/svg"
               fill="none"
               viewBox="0 0 24 24"
               stroke-width="2"
               stroke="currentColor"
               class="w-5 h-5"
            >
               <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M6 18L18 6M6 6l12 12"
               />
            </svg>
         </button>
      </div>

      <div class="flex flex-col gap-6">
         <div class="flex flex-col items-center justify-center py-2">
            <app-interactive-stars
               [rating]="rating"
               (ratingChange)="onRatingChanged($event)"
            >
            </app-interactive-stars>

            <p
               class="text-orange-base font-semibold mt-2 h-5 text-sm md:text-base transition-opacity duration-300"
               [class.opacity-0]="rating === 0"
            >
               {{ ratingLabels[rating] || "" }}
            </p>
         </div>

         <div class="w-full">
            <label
               for="reviewContent"
               class="block text-sm font-semibold text-primary mb-2"
            >
               Seu comentário
               <span class="font-normal text-gray-400">(opcional)</span>
            </label>
            <div class="relative">
               <textarea
                  id="reviewContent"
                  [(ngModel)]="content"
                  rows="4"
                  maxlength="500"
                  placeholder="Conte como foi sua experiência..."
                  tabindex="1"
                  class="w-full border border-gray-300 rounded-xl p-3 pr-14 text-sm md:text-base placeholder:text-gray-400 focus:ring-2 focus:ring-orange-base/20 focus:border-orange-base transition resize-none outline-none"
               ></textarea>
               <span
                  class="absolute bottom-3 right-3 text-xs text-gray-400 font-medium"
               >
                  {{ content.length }}/500
               </span>
            </div>
         </div>
      </div>

      <div
         class="flex flex-col-reverse sm:flex-row items-stretch sm:items-center sm:justify-end gap-3 mt-2"
      >
         <app-button
            (click)="onCloseModal()"
            [label]="'Cancelar'"
            [color]="
               'bg-gray-600 hover:bg-gray-700 border border-gray-300 text-gray-700 hover:bg-gray-50'
            "
            class="w-full sm:w-auto"
         ></app-button>

         <app-button
            (click)="onSubmit()"
            [label]="'Enviar Avaliação'"
            [disabled]="rating === 0"
            [color]="'bg-orange-base hover:bg-orange-dark'"
            class="w-full sm:w-auto"
         ></app-button>
      </div>
   </div>
</div>
